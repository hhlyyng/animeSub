import{_ as e,o as a,c as d,a2 as n}from"./chunks/framework.D3n7QxxD.js";const u=JSON.parse('{"title":"å¼€å‘å‚è€ƒ","description":"","frontmatter":{},"headers":[],"relativePath":"zh/dev-reference.md","filePath":"zh/dev-reference.md"}'),s={name:"zh/dev-reference.md"};function o(c,t,i,r,p,l){return a(),d("div",null,[...t[0]||(t[0]=[n(`<h1 id="å¼€å‘å‚è€ƒ" tabindex="-1">å¼€å‘å‚è€ƒ <a class="header-anchor" href="#å¼€å‘å‚è€ƒ" aria-label="Permalink to &quot;å¼€å‘å‚è€ƒ&quot;">â€‹</a></h1><p>æœ¬æ–‡æ¡£è®°å½•ç³»ç»Ÿå½“å‰æ¶æ„ã€æ‰€æœ‰æºæ–‡ä»¶ä½œç”¨åŠåç«¯å®Œæ•´ API åˆ—è¡¨ï¼Œä¾›å¼€å‘è€…å‚è€ƒã€‚</p><hr><h2 id="ç³»ç»Ÿæ¶æ„å›¾" tabindex="-1">ç³»ç»Ÿæ¶æ„å›¾ <a class="header-anchor" href="#ç³»ç»Ÿæ¶æ„å›¾" aria-label="Permalink to &quot;ç³»ç»Ÿæ¶æ„å›¾&quot;">â€‹</a></h2><h3 id="æ•´ä½“æ¶æ„" tabindex="-1">æ•´ä½“æ¶æ„ <a class="header-anchor" href="#æ•´ä½“æ¶æ„" aria-label="Permalink to &quot;æ•´ä½“æ¶æ„&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span>
<span class="line"><span>â”‚                         ç”¨æˆ·æµè§ˆå™¨                                â”‚</span></span>
<span class="line"><span>â”‚                                                                  â”‚</span></span>
<span class="line"><span>â”‚  React 19 + TypeScript + Vite + Tailwind CSS + Zustand          â”‚</span></span>
<span class="line"><span>â”‚                                                                  â”‚</span></span>
<span class="line"><span>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚</span></span>
<span class="line"><span>â”‚  â”‚ é¦–é¡µæ”¾é€  â”‚  â”‚ æœç´¢/ä¸‹è½½ â”‚  â”‚  è®¢é˜…ç®¡ç† â”‚  â”‚   ç³»ç»Ÿè®¾ç½®   â”‚  â”‚</span></span>
<span class="line"><span>â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚</span></span>
<span class="line"><span>â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚</span></span>
<span class="line"><span>â”‚                          authFetch()                            â”‚</span></span>
<span class="line"><span>â”‚                     (Bearer JWT + 401 é‡å®šå‘)                   â”‚</span></span>
<span class="line"><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span>
<span class="line"><span>                              â”‚ HTTP / JSON</span></span>
<span class="line"><span>                              â–¼</span></span>
<span class="line"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span>
<span class="line"><span>â”‚                     ASP.NET Core 9 åç«¯                          â”‚</span></span>
<span class="line"><span>â”‚                      localhost:5072                              â”‚</span></span>
<span class="line"><span>â”‚                                                                  â”‚</span></span>
<span class="line"><span>â”‚  Middleware Pipeline:                                           â”‚</span></span>
<span class="line"><span>â”‚  CorrelationId â†’ ExceptionHandler â†’ PerfMonitor â†’ ReqLogging   â”‚</span></span>
<span class="line"><span>â”‚                                                                  â”‚</span></span>
<span class="line"><span>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚</span></span>
<span class="line"><span>â”‚  â”‚                      Controllers                          â”‚  â”‚</span></span>
<span class="line"><span>â”‚  â”‚  AnimeController  â”‚ AuthController  â”‚ SubscriptionCtrl   â”‚  â”‚</span></span>
<span class="line"><span>â”‚  â”‚  MikanController  â”‚ AdminController â”‚ SettingsController  â”‚  â”‚</span></span>
<span class="line"><span>â”‚  â”‚                   HealthController                         â”‚  â”‚</span></span>
<span class="line"><span>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚</span></span>
<span class="line"><span>â”‚             â”‚                                                    â”‚</span></span>
<span class="line"><span>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚</span></span>
<span class="line"><span>â”‚  â”‚                     Services Layer                         â”‚  â”‚</span></span>
<span class="line"><span>â”‚  â”‚                                                            â”‚  â”‚</span></span>
<span class="line"><span>â”‚  â”‚  AnimeAggregationService   SubscriptionService            â”‚  â”‚</span></span>
<span class="line"><span>â”‚  â”‚  AnimePoolService          AuthService                     â”‚  â”‚</span></span>
<span class="line"><span>â”‚  â”‚  QBittorrentService        MikanClient                     â”‚  â”‚</span></span>
<span class="line"><span>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚</span></span>
<span class="line"><span>â”‚             â”‚                          â”‚                          â”‚</span></span>
<span class="line"><span>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚</span></span>
<span class="line"><span>â”‚  â”‚   Repositories      â”‚  â”‚      Background Services           â”‚  â”‚</span></span>
<span class="line"><span>â”‚  â”‚   AnimeRepository   â”‚  â”‚  AnimePreFetchService (æ¯æ—¥03:00)  â”‚  â”‚</span></span>
<span class="line"><span>â”‚  â”‚ SubscriptionRepo    â”‚  â”‚  RssPollingService   (æ¯30åˆ†é’Ÿ)    â”‚  â”‚</span></span>
<span class="line"><span>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  DownloadProgressSync (å®æ—¶åŒæ­¥)   â”‚  â”‚</span></span>
<span class="line"><span>â”‚             â”‚              â”‚  AnimeTitleBackfill  (è¡¥å…¨æ ‡é¢˜)    â”‚  â”‚</span></span>
<span class="line"><span>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  MikanFeedCleanup    (æ¸…ç†ç¼“å­˜)   â”‚  â”‚</span></span>
<span class="line"><span>â”‚  â”‚   SQLite Database   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚</span></span>
<span class="line"><span>â”‚  â”‚   (anime.db)        â”‚                                          â”‚</span></span>
<span class="line"><span>â”‚  â”‚                     â”‚                                          â”‚</span></span>
<span class="line"><span>â”‚  â”‚  AnimeInfo          â”‚                                          â”‚</span></span>
<span class="line"><span>â”‚  â”‚  AnimeImages        â”‚                                          â”‚</span></span>
<span class="line"><span>â”‚  â”‚  Subscriptions      â”‚                                          â”‚</span></span>
<span class="line"><span>â”‚  â”‚  DownloadHistory    â”‚                                          â”‚</span></span>
<span class="line"><span>â”‚  â”‚  DailyScheduleCache â”‚                                          â”‚</span></span>
<span class="line"><span>â”‚  â”‚  MikanFeedCache     â”‚                                          â”‚</span></span>
<span class="line"><span>â”‚  â”‚  MikanFeedItem      â”‚                                          â”‚</span></span>
<span class="line"><span>â”‚  â”‚  MikanSubgroup      â”‚                                          â”‚</span></span>
<span class="line"><span>â”‚  â”‚  TopAnimeCache      â”‚                                          â”‚</span></span>
<span class="line"><span>â”‚  â”‚  User               â”‚                                          â”‚</span></span>
<span class="line"><span>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚</span></span>
<span class="line"><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span>
<span class="line"><span>                              â”‚</span></span>
<span class="line"><span>          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span>
<span class="line"><span>          â–¼                   â–¼                        â–¼</span></span>
<span class="line"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span>
<span class="line"><span>â”‚   Bangumi API   â”‚  â”‚    TMDB API      â”‚  â”‚   AniList GraphQL   â”‚</span></span>
<span class="line"><span>â”‚ api.bgm.tv/v0   â”‚  â”‚ api.tmdb.org/3   â”‚  â”‚  graphql.anilist.co â”‚</span></span>
<span class="line"><span>â”‚                 â”‚  â”‚                  â”‚  â”‚                     â”‚</span></span>
<span class="line"><span>â”‚ æ¯æ—¥æ”¾é€æ—¶é—´è¡¨  â”‚  â”‚ è‹±æ–‡å…ƒæ•°æ®       â”‚  â”‚ è‹±æ–‡æ ‡é¢˜/ç®€ä»‹       â”‚</span></span>
<span class="line"><span>â”‚ è¯„åˆ†æ’è¡Œæ¦œ      â”‚  â”‚ æ¨ªç‰ˆèƒŒæ™¯å›¾       â”‚  â”‚ è¶‹åŠ¿æ’è¡Œæ¦œ          â”‚</span></span>
<span class="line"><span>â”‚ åŠ¨æ¼«è¯¦æƒ…        â”‚  â”‚ æ™ºèƒ½å­£åº¦åŒ¹é…     â”‚  â”‚ (å¤‡ç”¨æ¥æº)          â”‚</span></span>
<span class="line"><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span>
<span class="line"><span>          â”‚</span></span>
<span class="line"><span>          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span>
<span class="line"><span>          â–¼                         â–¼</span></span>
<span class="line"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span>
<span class="line"><span>â”‚   Jikan API     â”‚       â”‚     Mikan RSS         â”‚</span></span>
<span class="line"><span>â”‚ api.jikan.moe   â”‚       â”‚   mikanani.me         â”‚</span></span>
<span class="line"><span>â”‚                 â”‚       â”‚                       â”‚</span></span>
<span class="line"><span>â”‚ MAL Top 10      â”‚       â”‚ ç•ªå‰§ RSS ç§å­åˆ—è¡¨     â”‚</span></span>
<span class="line"><span>â”‚ (MyAnimeList)   â”‚       â”‚ å­—å¹•ç»„åˆ†ç»„ä¿¡æ¯        â”‚</span></span>
<span class="line"><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span>
<span class="line"><span>                                     â”‚</span></span>
<span class="line"><span>                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span>
<span class="line"><span>                          â”‚    qBittorrent WebUI  â”‚</span></span>
<span class="line"><span>                          â”‚    localhost:8080      â”‚</span></span>
<span class="line"><span>                          â”‚                       â”‚</span></span>
<span class="line"><span>                          â”‚  ç§å­æ·»åŠ /æš‚åœ/æ¢å¤   â”‚</span></span>
<span class="line"><span>                          â”‚  ä¸‹è½½è¿›åº¦æŸ¥è¯¢         â”‚</span></span>
<span class="line"><span>                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span></code></pre></div><h3 id="æ•°æ®èšåˆæµç¨‹" tabindex="-1">æ•°æ®èšåˆæµç¨‹ <a class="header-anchor" href="#æ•°æ®èšåˆæµç¨‹" aria-label="Permalink to &quot;æ•°æ®èšåˆæµç¨‹&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>GET /api/anime/today</span></span>
<span class="line"><span>        â”‚</span></span>
<span class="line"><span>        â–¼</span></span>
<span class="line"><span>AnimeAggregationService</span></span>
<span class="line"><span>        â”‚</span></span>
<span class="line"><span>        â”œâ”€â‘  æŸ¥è¯¢ SQLite (GetAnimesByWeekdayAsync)</span></span>
<span class="line"><span>        â”‚         â”‚</span></span>
<span class="line"><span>        â”‚    æœ‰é¢„å–æ•°æ®? â”€â”€æ˜¯â”€â”€â–º è¿”å› DB æ•°æ® (&lt;100ms)</span></span>
<span class="line"><span>        â”‚         â”‚</span></span>
<span class="line"><span>        â”‚         å¦</span></span>
<span class="line"><span>        â”‚         â–¼</span></span>
<span class="line"><span>        â”œâ”€â‘¡ Bangumi API</span></span>
<span class="line"><span>        â”‚   GET /v0/calendar â†’ è·å–æœ¬å‘¨æ”¾é€</span></span>
<span class="line"><span>        â”‚   æ¯éƒ¨ç•ªå‰§: id, name, air_date, score, å°é¢å›¾</span></span>
<span class="line"><span>        â”‚         â”‚</span></span>
<span class="line"><span>        â”œâ”€â‘¢ TMDB API (å¹¶å‘)</span></span>
<span class="line"><span>        â”‚   æœç´¢ç•ªå‰§å â†’ æ™ºèƒ½åŒ¹é… (Animationä¼˜å…ˆ/JPä¼˜å…ˆ/å¹´ä»½è¿‡æ»¤)</span></span>
<span class="line"><span>        â”‚   GET /3/search/tv â†’ GET /3/tv/{id}/season/{n}</span></span>
<span class="line"><span>        â”‚   æå–: è‹±æ–‡æ ‡é¢˜, è‹±æ–‡ç®€ä»‹, æ¨ªç‰ˆèƒŒæ™¯å›¾</span></span>
<span class="line"><span>        â”‚         â”‚</span></span>
<span class="line"><span>        â””â”€â‘£ AniList GraphQL (å¤‡ç”¨)</span></span>
<span class="line"><span>            query { Media } â†’ è‹±æ–‡æ ‡é¢˜/ç®€ä»‹ (Bangumiæœ‰æ•°æ®æ—¶è·³è¿‡)</span></span>
<span class="line"><span>                    â”‚</span></span>
<span class="line"><span>                    â–¼</span></span>
<span class="line"><span>             AnimeInfo[] â†’ è¿”å›å‰ç«¯ â†’ ç¼“å­˜è‡³ sessionStorage</span></span></code></pre></div><h3 id="é¢„å–æ¶æ„" tabindex="-1">é¢„å–æ¶æ„ <a class="header-anchor" href="#é¢„å–æ¶æ„" aria-label="Permalink to &quot;é¢„å–æ¶æ„&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>AnimePreFetchService (BackgroundService)</span></span>
<span class="line"><span>        â”‚</span></span>
<span class="line"><span>        â”œâ”€â”€ å¯åŠ¨æ—¶: RunOnStartup=true â†’ ç«‹å³æ‰§è¡Œä¸€æ¬¡</span></span>
<span class="line"><span>        â”‚</span></span>
<span class="line"><span>        â””â”€â”€ å®šæ—¶: æ¯å¤© ScheduleHour (é»˜è®¤å‡Œæ™¨3ç‚¹)</span></span>
<span class="line"><span>                  â”‚</span></span>
<span class="line"><span>                  â”œâ”€ GetFullCalendarAsync() â†’ è·å–å…¨å‘¨ Bangumi æ•°æ®</span></span>
<span class="line"><span>                  â”œâ”€ å¹¶å‘èšåˆ (MaxConcurrency=3)</span></span>
<span class="line"><span>                  â”‚   æ¯éƒ¨ç•ªå‰§ â†’ TMDB + AniList ä¸°å¯Œå…ƒæ•°æ®</span></span>
<span class="line"><span>                  â””â”€ æ‰¹é‡å†™å…¥ SQLite</span></span>
<span class="line"><span>                     è®¾ç½® IsPreFetched=true</span></span></code></pre></div><h3 id="è®¢é˜…ä¸‹è½½æµç¨‹" tabindex="-1">è®¢é˜…ä¸‹è½½æµç¨‹ <a class="header-anchor" href="#è®¢é˜…ä¸‹è½½æµç¨‹" aria-label="Permalink to &quot;è®¢é˜…ä¸‹è½½æµç¨‹&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>RssPollingService (æ¯30åˆ†é’Ÿ)</span></span>
<span class="line"><span>        â”‚</span></span>
<span class="line"><span>        â”œâ”€ æ£€æŸ¥ EnablePolling é…ç½®</span></span>
<span class="line"><span>        â”‚</span></span>
<span class="line"><span>        â””â”€ éå†æ‰€æœ‰ IsEnabled=true çš„è®¢é˜…</span></span>
<span class="line"><span>                  â”‚</span></span>
<span class="line"><span>                  â–¼</span></span>
<span class="line"><span>          MikanClient.GetFeedAsync(mikanBangumiId, subgroupId)</span></span>
<span class="line"><span>                  â”‚</span></span>
<span class="line"><span>                  â–¼</span></span>
<span class="line"><span>          è§£æ RSS XML â†’ MikanFeedItem[]</span></span>
<span class="line"><span>                  â”‚</span></span>
<span class="line"><span>                  â–¼</span></span>
<span class="line"><span>          è¿‡æ»¤æµç¨‹:</span></span>
<span class="line"><span>          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span>
<span class="line"><span>          â”‚ 1. TorrentHash âˆˆ DownloadHistory?  â”‚</span></span>
<span class="line"><span>          â”‚    æ˜¯ â†’ è·³è¿‡ (å·²ä¸‹è½½)              â”‚</span></span>
<span class="line"><span>          â”‚    å¦ â†’ ç»§ç»­                        â”‚</span></span>
<span class="line"><span>          â”‚ 2. å­—å¹•ç»„ ID åŒ¹é…?                 â”‚</span></span>
<span class="line"><span>          â”‚    ä¸åŒ¹é… â†’ è·³è¿‡                   â”‚</span></span>
<span class="line"><span>          â”‚ 3. KeywordInclude å…¨éƒ¨å‘½ä¸­?        â”‚</span></span>
<span class="line"><span>          â”‚    å¦ â†’ è·³è¿‡                        â”‚</span></span>
<span class="line"><span>          â”‚ 4. KeywordExclude ä»»ä¸€å‘½ä¸­?        â”‚</span></span>
<span class="line"><span>          â”‚    æ˜¯ â†’ è·³è¿‡                        â”‚</span></span>
<span class="line"><span>          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span>
<span class="line"><span>                  â”‚</span></span>
<span class="line"><span>                  â–¼ (é€šè¿‡è¿‡æ»¤)</span></span>
<span class="line"><span>          QBittorrentService.AddTorrentAsync()</span></span>
<span class="line"><span>                  â”‚</span></span>
<span class="line"><span>                  â–¼</span></span>
<span class="line"><span>          å†™å…¥ DownloadHistory (Status=Downloading)</span></span>
<span class="line"><span>          æ›´æ–° Subscription.LastDownloadAt</span></span></code></pre></div><hr><h2 id="åç«¯æ–‡ä»¶æ¸…å•" tabindex="-1">åç«¯æ–‡ä»¶æ¸…å• <a class="header-anchor" href="#åç«¯æ–‡ä»¶æ¸…å•" aria-label="Permalink to &quot;åç«¯æ–‡ä»¶æ¸…å•&quot;">â€‹</a></h2><h3 id="controllers" tabindex="-1">Controllers <a class="header-anchor" href="#controllers" aria-label="Permalink to &quot;Controllers&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è·¯ç”±å‰ç¼€</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>Controllers/AnimeController.cs</code></td><td><code>/api/anime</code></td><td>åŠ¨æ¼«æ•°æ®èšåˆï¼šä»Šæ—¥æ”¾é€ã€Top10ã€æœç´¢ã€éšæœºæ¨èã€æ‰¹é‡æŸ¥è¯¢</td></tr><tr><td><code>Controllers/AuthController.cs</code></td><td><code>/api/auth</code></td><td>è®¤è¯ç³»ç»Ÿï¼šç™»å½•ã€æ³¨å†Œã€å®‰è£…å‘å¯¼ã€ä¿®æ”¹å¯†ç ã€èƒŒæ™¯å›¾ç®¡ç†</td></tr><tr><td><code>Controllers/SubscriptionController.cs</code></td><td><code>/api/subscription</code></td><td>è®¢é˜…ç®¡ç†ï¼šCRUDã€æ‰‹åŠ¨æ£€æŸ¥ã€ä¸‹è½½å†å²ã€ä»»åŠ¡ Hash æŸ¥è¯¢</td></tr><tr><td><code>Controllers/MikanController.cs</code></td><td><code>/api/mikan</code></td><td>Mikan æ“ä½œï¼šRSS æœç´¢/è§£æ/è¿‡æ»¤ã€ç§å­ä¸‹è½½ã€qBittorrent æ§åˆ¶</td></tr><tr><td><code>Controllers/AdminController.cs</code></td><td><code>/api/admin</code></td><td>ç®¡ç†æ¥å£ï¼šé¢„å–çŠ¶æ€ã€æ‰‹åŠ¨è§¦å‘é¢„å–ã€æ•°æ®åº“ç»Ÿè®¡ã€æ¸…ç©ºæ•°æ®</td></tr><tr><td><code>Controllers/SettingsController.cs</code></td><td><code>/api/settings</code></td><td>è®¾ç½®ç®¡ç†ï¼šToken è¯»å†™ã€ç”¨æˆ·é…ç½®ã€è¿æ¥æµ‹è¯•</td></tr><tr><td><code>Controllers/HealthController.cs</code></td><td><code>/health</code></td><td>å¥åº·æ£€æŸ¥ï¼šåŸºç¡€å¿ƒè·³ã€å¤–éƒ¨ API ä¾èµ–æ£€æŸ¥</td></tr></tbody></table><h3 id="services-interfaces" tabindex="-1">Services/Interfaces <a class="header-anchor" href="#services-interfaces" aria-label="Permalink to &quot;Services/Interfaces&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>IAnimeAggregationService.cs</code></td><td>æ•°æ®èšåˆæœåŠ¡æ¥å£ï¼šå®šä¹‰ä»Šæ—¥æ”¾é€ã€Top10ã€æœç´¢ç­‰èšåˆæ–¹æ³•</td></tr><tr><td><code>IAnimePoolService.cs</code></td><td>éšæœºæ¨èæ± æ¥å£ï¼šè·å–éšæœºç•ªå‰§åˆ—è¡¨</td></tr><tr><td><code>IAniListClient.cs</code></td><td>AniList GraphQL å®¢æˆ·ç«¯æ¥å£</td></tr><tr><td><code>IBangumiClient.cs</code></td><td>Bangumi HTTP å®¢æˆ·ç«¯æ¥å£ï¼šæ”¾é€ã€æ’è¡Œã€è¯¦æƒ…</td></tr><tr><td><code>IJikanClient.cs</code></td><td>Jikanï¼ˆMALï¼‰HTTP å®¢æˆ·ç«¯æ¥å£</td></tr><tr><td><code>IMikanClient.cs</code></td><td>Mikan RSS å®¢æˆ·ç«¯æ¥å£ï¼šæœç´¢ã€è§£æã€å­—å¹•ç»„</td></tr><tr><td><code>IQBittorrentService.cs</code></td><td>qBittorrent WebUI æ¥å£ï¼šæ·»åŠ /æš‚åœ/æ¢å¤/åˆ é™¤/æŸ¥è¯¢</td></tr><tr><td><code>ISubscriptionService.cs</code></td><td>è®¢é˜…ä¸šåŠ¡é€»è¾‘æ¥å£</td></tr><tr><td><code>ITMDBClient.cs</code></td><td>TMDB API å®¢æˆ·ç«¯æ¥å£ï¼šæœç´¢ã€å­£åº¦å›¾ç‰‡</td></tr><tr><td><code>IAuthService.cs</code></td><td>è®¤è¯æœåŠ¡æ¥å£ï¼šç™»å½•éªŒè¯ã€JWT ç”Ÿæˆã€å¯†ç ä¿®æ”¹</td></tr><tr><td><code>ITorrentTitleParser.cs</code></td><td>ç§å­æ ‡é¢˜è§£ææ¥å£ï¼šæå–é›†æ•°ã€åˆ†è¾¨ç‡ã€å­—å¹•ç»„</td></tr></tbody></table><h3 id="services-implementations" tabindex="-1">Services/Implementations <a class="header-anchor" href="#services-implementations" aria-label="Permalink to &quot;Services/Implementations&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>AnimeAggregationService.cs</code></td><td>æ ¸å¿ƒèšåˆæœåŠ¡ï¼šåè°ƒ Bangumiâ†’TMDBâ†’AniList æ•°æ®ï¼ŒDB ä¼˜å…ˆè¯»å–</td></tr><tr><td><code>AnimePoolService.cs</code></td><td>éšæœºæ¨èæ± ï¼šå†…å­˜ç¼“å­˜ + SQLite L2 å¤‡é€‰ï¼Œå¯åŠ¨æ—¶é¢„çƒ­</td></tr><tr><td><code>AnimePoolBuilderService.cs</code></td><td>æ¨èæ± æ„å»ºå™¨ï¼šä» AniList è·å–çƒ­é—¨ç•ªå‰§å¡«å……æ¨èæ± </td></tr><tr><td><code>AniListClient.cs</code></td><td>AniList GraphQL å®¢æˆ·ç«¯å®ç°ï¼štrending æŸ¥è¯¢ã€æ ‡é¢˜/ç®€ä»‹æå–</td></tr><tr><td><code>BangumiClient.cs</code></td><td>Bangumi API å®ç°ï¼š<code>/v0/calendar</code>ã€<code>/v0/subjects</code> æ’è¡Œ</td></tr><tr><td><code>JikanClient.cs</code></td><td>Jikan API å®ç°ï¼š<code>/v4/top/anime</code> MAL æ’è¡Œ</td></tr><tr><td><code>MikanClient.cs</code></td><td>Mikan å®ç°ï¼šHtmlAgilityPack è§£æç•ªå‰§é¡µã€XML è§£æ RSS</td></tr><tr><td><code>QBittorrentService.cs</code></td><td>qBittorrent WebUI API å°è£…ï¼šç™»å½• cookie ç®¡ç†ã€ç§å­æ“ä½œ</td></tr><tr><td><code>SubscriptionService.cs</code></td><td>è®¢é˜…ä¸šåŠ¡é€»è¾‘ï¼šCRUDã€RSS æ£€æŸ¥ã€å…³é”®è¯è¿‡æ»¤</td></tr><tr><td><code>TMDBClient.cs</code></td><td>TMDB å®ç°ï¼šTV æœç´¢ + Animation ä¼˜å…ˆåŒ¹é… + å­£åº¦å›¾ç‰‡</td></tr></tbody></table><h3 id="services-background" tabindex="-1">Services/Background <a class="header-anchor" href="#services-background" aria-label="Permalink to &quot;Services/Background&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è§¦å‘æ—¶æœº</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>AnimePreFetchService.cs</code></td><td>å¯åŠ¨æ—¶ + æ¯æ—¥å‡Œæ™¨3ç‚¹</td><td>æ‰¹é‡é¢„å–å…¨å‘¨æ”¾é€æ•°æ®å†™å…¥ SQLite</td></tr><tr><td><code>RssPollingService.cs</code></td><td>å¯åŠ¨30ç§’å + æ¯30åˆ†é’Ÿ</td><td>æ£€æŸ¥æ‰€æœ‰è®¢é˜… RSSï¼Œè‡ªåŠ¨ä¸‹è½½æ–°ç§å­</td></tr><tr><td><code>DownloadProgressSyncService.cs</code></td><td>åå°æŒç»­è¿è¡Œ</td><td>å®šæœŸåŒæ­¥ qBittorrent ä¸‹è½½è¿›åº¦åˆ° DownloadHistory</td></tr><tr><td><code>AnimeTitleBackfillService.cs</code></td><td>å¯åŠ¨æ—¶</td><td>è¡¥å…¨æ•°æ®åº“ä¸­ç¼ºå¤±çš„ä¸­æ–‡æ ‡é¢˜ï¼ˆBangumi fallbackï¼‰</td></tr><tr><td><code>MikanFeedSubgroupCleanupService.cs</code></td><td>å®šæœŸ</td><td>æ¸…ç†è¿‡æœŸçš„ Mikan Feed ç¼“å­˜æ•°æ®</td></tr></tbody></table><h3 id="services-repositories" tabindex="-1">Services/Repositories <a class="header-anchor" href="#services-repositories" aria-label="Permalink to &quot;Services/Repositories&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>IAnimeRepository.cs</code> / <code>AnimeRepository.cs</code></td><td>åŠ¨æ¼«æ•°æ®è®¿é—®ï¼šæŒ‰æ˜ŸæœŸæŸ¥è¯¢ã€æ‰¹é‡å†™å…¥ã€Top ç¼“å­˜ç®¡ç†</td></tr><tr><td><code>ISubscriptionRepository.cs</code> / <code>SubscriptionRepository.cs</code></td><td>è®¢é˜…æ•°æ®è®¿é—®ï¼šCRUDã€æŒ‰ Bangumi ID æŸ¥è¯¢ã€å†å²è®°å½•</td></tr></tbody></table><h3 id="services-å·¥å…·ç±»" tabindex="-1">Servicesï¼ˆå·¥å…·ç±»ï¼‰ <a class="header-anchor" href="#services-å·¥å…·ç±»" aria-label="Permalink to &quot;Servicesï¼ˆå·¥å…·ç±»ï¼‰&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>ApiClientBase.cs</code></td><td>HTTP å®¢æˆ·ç«¯åŸºç±»ï¼šç»Ÿä¸€é”™è¯¯å¤„ç†ã€æ—¥å¿—ã€BaseAddress ç®¡ç†</td></tr><tr><td><code>AnimeCacheService.cs</code></td><td>ä¸¤çº§ç¼“å­˜ï¼šMemory Cacheï¼ˆL1ï¼‰+ SQLiteï¼ˆL2ï¼‰</td></tr><tr><td><code>AuthService.cs</code></td><td>JWT ç”Ÿæˆï¼ˆHMAC-SHA256ï¼‰ã€bcrypt å¯†ç å“ˆå¸Œã€ç”¨æˆ·éªŒè¯</td></tr><tr><td><code>HealthCheckService.cs</code></td><td>å¤–éƒ¨ API ä¾èµ–æ£€æŸ¥ï¼ˆBangumi/TMDB/AniList è¿é€šæ€§ï¼‰</td></tr><tr><td><code>TokenStorageService.cs</code></td><td>TMDB Token åŠ å¯†å­˜å‚¨ï¼ˆASP.NET Data Protection APIï¼‰</td></tr><tr><td><code>ResilienceService.cs</code></td><td>Polly é‡è¯•ç­–ç•¥ + ç†”æ–­å™¨ï¼Œä¿æŠ¤å¤–éƒ¨ API è°ƒç”¨</td></tr></tbody></table><h3 id="services-utilities" tabindex="-1">Services/Utilities <a class="header-anchor" href="#services-utilities" aria-label="Permalink to &quot;Services/Utilities&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>Utilities/TitleCleaner.cs</code></td><td>åŠ¨æ¼«æ ‡é¢˜è§„èŒƒåŒ–ï¼šå»é™¤å™ªå£°å­—ç¬¦ã€ç»Ÿä¸€æ ¼å¼</td></tr><tr><td><code>Utilities/TitleLanguageResolver.cs</code></td><td>æ ‡é¢˜è¯­è¨€æ£€æµ‹ï¼šåˆ¤æ–­ä¸­/æ—¥/è‹±æ–‡</td></tr><tr><td><code>Utils/TorrentHashHelper.cs</code></td><td>ç§å­ Hash è®¡ç®—è¾…åŠ©</td></tr></tbody></table><h3 id="services-exceptions" tabindex="-1">Services/Exceptions <a class="header-anchor" href="#services-exceptions" aria-label="Permalink to &quot;Services/Exceptions&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>ApiException.cs</code></td><td>é€šç”¨ API å¼‚å¸¸åŸºç±»</td></tr><tr><td><code>BangumiApiException.cs</code></td><td>Bangumi API ä¸“å±å¼‚å¸¸</td></tr><tr><td><code>ExternalApiException.cs</code></td><td>å¤–éƒ¨ API è°ƒç”¨å¤±è´¥å¼‚å¸¸</td></tr><tr><td><code>InvalidCredentialsException.cs</code></td><td>è®¤è¯å‡­æ®æ— æ•ˆå¼‚å¸¸</td></tr><tr><td><code>QBittorrentUnavailableException.cs</code></td><td>qBittorrent è¿æ¥ä¸å¯ç”¨å¼‚å¸¸</td></tr><tr><td><code>ValidationException.cs</code></td><td>è¯·æ±‚æ•°æ®éªŒè¯å¤±è´¥å¼‚å¸¸</td></tr></tbody></table><h3 id="data-æ•°æ®å±‚" tabindex="-1">Dataï¼ˆæ•°æ®å±‚ï¼‰ <a class="header-anchor" href="#data-æ•°æ®å±‚" aria-label="Permalink to &quot;Dataï¼ˆæ•°æ®å±‚ï¼‰&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>Data/AnimeDbContext.cs</code></td><td>EF Core SQLite ä¸Šä¸‹æ–‡ï¼Œå®šä¹‰æ‰€æœ‰ DbSet</td></tr><tr><td><code>Data/DbSchemaPatcher.cs</code></td><td>è½»é‡æ•°æ®åº“ Schema è¿ç§»ï¼ˆè¡¥ä¸æ¨¡å¼ï¼‰</td></tr><tr><td><code>Data/Entities/AnimeInfoEntity.cs</code></td><td>èšåˆåŠ¨æ¼«ä¿¡æ¯ï¼ˆæ ‡é¢˜/è¯„åˆ†/å›¾ç‰‡/é“¾æ¥/æ˜ŸæœŸ/é¢„å–çŠ¶æ€ï¼‰</td></tr><tr><td><code>Data/Entities/AnimeImagesEntity.cs</code></td><td>å›¾ç‰‡ç¼“å­˜ï¼ˆç«–ç‰ˆå°é¢ + æ¨ªç‰ˆèƒŒæ™¯å›¾ï¼‰</td></tr><tr><td><code>Data/Entities/DailyScheduleCacheEntity.cs</code></td><td>æ¯æ—¥æ”¾é€ç¼“å­˜ï¼ˆæ—¥æœŸ â†’ Bangumi ID æ•°ç»„ï¼‰</td></tr><tr><td><code>Data/Entities/DownloadHistoryEntity.cs</code></td><td>ä¸‹è½½å†å²ï¼ˆHash å»é‡ã€çŠ¶æ€è¿½è¸ªï¼‰</td></tr><tr><td><code>Data/Entities/DownloadSource.cs</code></td><td>æšä¸¾ï¼šSubscription / Manual</td></tr><tr><td><code>Data/Entities/MikanFeedCacheEntity.cs</code></td><td>Mikan RSS Feed ç¼“å­˜</td></tr><tr><td><code>Data/Entities/MikanFeedItemEntity.cs</code></td><td>å•æ¡ Feed è®°å½•ï¼ˆç§å­æ ‡é¢˜/URL/Hashï¼‰</td></tr><tr><td><code>Data/Entities/MikanSubgroupEntity.cs</code></td><td>å­—å¹•ç»„ ID â†” åç§°æ˜ å°„ç¼“å­˜</td></tr><tr><td><code>Data/Entities/SubscriptionEntity.cs</code></td><td>è®¢é˜…é…ç½®ï¼ˆç•ªå‰§/å­—å¹•ç»„/å…³é”®è¯/çŠ¶æ€ï¼‰</td></tr><tr><td><code>Data/Entities/TopAnimeCacheEntity.cs</code></td><td>Top 10 æ’è¡Œç¼“å­˜ï¼ˆæ¥æº/æ•°æ®/è¿‡æœŸæ—¶é—´ï¼‰</td></tr><tr><td><code>Data/Entities/UserEntity.cs</code></td><td>ç”¨æˆ·è´¦æˆ·ï¼ˆç”¨æˆ·å/bcrypt å¯†ç å“ˆå¸Œï¼‰</td></tr></tbody></table><h3 id="middleware" tabindex="-1">Middleware <a class="header-anchor" href="#middleware" aria-label="Permalink to &quot;Middleware&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>Middleware/CorrelationIdMiddleware.cs</code></td><td>ä¸ºæ¯ä¸ªè¯·æ±‚æ·»åŠ  <code>X-Correlation-ID</code> è¯·æ±‚è¿½è¸ª ID</td></tr><tr><td><code>Middleware/ExceptionHandlerMiddleware.cs</code></td><td>å…¨å±€å¼‚å¸¸æ•è·ï¼Œè¿”å›æ ‡å‡†åŒ–é”™è¯¯ JSON</td></tr><tr><td><code>Middleware/PerformanceMonitoringMiddleware.cs</code></td><td>è®°å½•è¯·æ±‚è€—æ—¶ï¼Œæ·»åŠ  <code>X-Response-Time-Ms</code> å“åº”å¤´</td></tr><tr><td><code>Middleware/RequestResponseLoggingMiddleware.cs</code></td><td>è®°å½•è¯·æ±‚/å“åº”æ—¥å¿—ï¼ˆè·¯å¾„/çŠ¶æ€ç /è€—æ—¶ï¼‰</td></tr></tbody></table><h3 id="models" tabindex="-1">Models <a class="header-anchor" href="#models" aria-label="Permalink to &quot;Models&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶/ç›®å½•</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>Models/AnimeResponse.cs</code></td><td>åŠ¨æ¼«åˆ—è¡¨å“åº”ï¼ˆå«æ•°æ®æ¥æºæ ‡è¯†ï¼šDB/APIï¼‰</td></tr><tr><td><code>Models/PreFetchStatus.cs</code></td><td>é¢„å–æœåŠ¡çŠ¶æ€ï¼ˆè¿è¡Œä¸­/ä¸Šæ¬¡æ‰§è¡Œæ—¶é—´/ç»Ÿè®¡ï¼‰</td></tr><tr><td><code>Models/ErrorResponse.cs</code></td><td>æ ‡å‡†é”™è¯¯å“åº”æ ¼å¼</td></tr><tr><td><code>Models/TMDBAnimeInfo.cs</code></td><td>TMDB æœç´¢ç»“æœæ˜ å°„æ¨¡å‹</td></tr><tr><td><code>Models/AniListAnimeInfo.cs</code></td><td>AniList GraphQL å“åº”æ˜ å°„</td></tr><tr><td><code>Models/Dtos/AnimeInfoDto.cs</code></td><td>èšåˆåŠ¨æ¼«ä¿¡æ¯ DTOï¼ˆå‰ç«¯å±•ç¤ºç”¨ï¼‰</td></tr><tr><td><code>Models/Dtos/AnimeImagesDto.cs</code></td><td>å›¾ç‰‡ DTO</td></tr><tr><td><code>Models/Dtos/ApiResponseDto.cs</code></td><td>ç»Ÿä¸€ API å“åº”åŒ…è£… <code>{ success, data, error }</code></td></tr><tr><td><code>Models/Dtos/BangumiAnimeDto.cs</code></td><td>Bangumi ç•ªå‰§ DTO</td></tr><tr><td><code>Models/Dtos/ExternalUrlsDto.cs</code></td><td>å¤–éƒ¨é“¾æ¥ï¼ˆBangumi/TMDB/AniList/MAL URLï¼‰</td></tr><tr><td><code>Models/Dtos/MikanSearchDtos.cs</code></td><td>Mikan æœç´¢ç»“æœ DTOï¼ˆç•ªå‰§åˆ—è¡¨/å­—å¹•ç»„ï¼‰</td></tr><tr><td><code>Models/Dtos/SubscriptionDtos.cs</code></td><td>è®¢é˜…è¯·æ±‚/å“åº” DTO</td></tr><tr><td><code>Models/Jikan/JikanModels.cs</code></td><td>Jikan API å“åº”æ¨¡å‹</td></tr><tr><td><code>Models/Mikan/MikanRssModels.cs</code></td><td>Mikan RSS XML è§£ææ¨¡å‹</td></tr><tr><td><code>Models/Configuration/ApiConfiguration.cs</code></td><td>TMDB/Jikan API é…ç½®ç±»</td></tr><tr><td><code>Models/Configuration/MikanConfiguration.cs</code></td><td>Mikan è½®è¯¢é…ç½®ç±»</td></tr><tr><td><code>Models/Configuration/QBittorrentConfiguration.cs</code></td><td>qBittorrent è¿æ¥é…ç½®ç±»</td></tr></tbody></table><h3 id="æ ¹ç›®å½•é…ç½®æ–‡ä»¶" tabindex="-1">æ ¹ç›®å½•é…ç½®æ–‡ä»¶ <a class="header-anchor" href="#æ ¹ç›®å½•é…ç½®æ–‡ä»¶" aria-label="Permalink to &quot;æ ¹ç›®å½•é…ç½®æ–‡ä»¶&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>Program.cs</code></td><td>åº”ç”¨å¯åŠ¨ï¼šDI æ³¨å†Œã€ä¸­é—´ä»¶ç®¡é“ã€æ•°æ®åº“åˆå§‹åŒ–</td></tr><tr><td><code>appsettings.json</code></td><td>é»˜è®¤é…ç½®ï¼ˆæ—¥å¿—çº§åˆ«ã€API åœ°å€ã€é»˜è®¤å€¼ï¼‰</td></tr><tr><td><code>appsettings.Development.json</code></td><td>å¼€å‘ç¯å¢ƒè¦†ç›–é…ç½®</td></tr><tr><td><code>appsettings.runtime.json</code></td><td>å®‰è£…å‘å¯¼å†™å…¥çš„è¿è¡Œæ—¶é…ç½®ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰</td></tr></tbody></table><hr><h2 id="å‰ç«¯æ–‡ä»¶æ¸…å•" tabindex="-1">å‰ç«¯æ–‡ä»¶æ¸…å• <a class="header-anchor" href="#å‰ç«¯æ–‡ä»¶æ¸…å•" aria-label="Permalink to &quot;å‰ç«¯æ–‡ä»¶æ¸…å•&quot;">â€‹</a></h2><h3 id="å…¥å£-è·¯ç”±" tabindex="-1">å…¥å£ &amp; è·¯ç”± <a class="header-anchor" href="#å…¥å£-è·¯ç”±" aria-label="Permalink to &quot;å…¥å£ &amp; è·¯ç”±&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>main.tsx</code></td><td>React åº”ç”¨å…¥å£ï¼ŒæŒ‚è½½ <code>&lt;App /&gt;</code> åˆ° <code>#root</code></td></tr><tr><td><code>App.tsx</code></td><td>æ ¹ç»„ä»¶ï¼šè·¯ç”±é…ç½®ï¼ˆRouterProviderï¼‰ã€è®¤è¯çŠ¶æ€æ£€æŸ¥ã€ProtectedRoute</td></tr><tr><td><code>index.css</code></td><td>å…¨å±€æ ·å¼ + Tailwind CSS + è‡ªå®šä¹‰ CSS ç±»ï¼ˆ<code>.sidebar-header</code>ã€<code>.content-header</code>ï¼‰</td></tr><tr><td><code>config/env.ts</code></td><td>ç¯å¢ƒå˜é‡è¯»å–ï¼ˆAPI base URL ç­‰ï¼‰</td></tr></tbody></table><h3 id="state-management" tabindex="-1">State Management <a class="header-anchor" href="#state-management" aria-label="Permalink to &quot;State Management&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>stores/useAppStores.tsx</code></td><td>Zustand storeï¼ŒæŒä¹…åŒ–åˆ° localStorage (<code>anime-app-storage</code>)ï¼šè¯­è¨€(zh/en)ã€ç”¨æˆ·åã€Modal å¼€å…³çŠ¶æ€</td></tr></tbody></table><h3 id="type-definitions" tabindex="-1">Type Definitions <a class="header-anchor" href="#type-definitions" aria-label="Permalink to &quot;Type Definitions&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>types/anime.ts</code></td><td><code>AnimeInfo</code>ã€<code>AnimeListResponse</code> ç­‰åŠ¨æ¼«ç›¸å…³ç±»å‹</td></tr><tr><td><code>types/auth.ts</code></td><td><code>LoginRequest</code>ã€<code>AuthStatus</code>ã€<code>SetupRequest</code> ç­‰è®¤è¯ç±»å‹</td></tr><tr><td><code>types/mikan.ts</code></td><td><code>MikanFeedItem</code>ã€<code>TorrentInfo</code>ã€<code>DownloadRequest</code> ç­‰ä¸‹è½½ç±»å‹</td></tr><tr><td><code>types/settings.ts</code></td><td><code>SettingsProfile</code>ã€<code>TokenStatus</code> ç­‰è®¾ç½®ç±»å‹</td></tr><tr><td><code>types/subscription.ts</code></td><td><code>Subscription</code>ã€<code>SubscriptionRequest</code>ã€<code>DownloadHistory</code> ç­‰è®¢é˜…ç±»å‹</td></tr></tbody></table><h3 id="api-services" tabindex="-1">API Services <a class="header-anchor" href="#api-services" aria-label="Permalink to &quot;API Services&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>services/apiClient.ts</code></td><td>æ ¸å¿ƒ HTTP å°è£…ï¼š<code>authFetch()</code>ï¼Œè‡ªåŠ¨é™„åŠ  Bearer Tokenï¼Œ401 æ—¶æ¸…é™¤ Token å¹¶è·³è½¬ç™»å½•</td></tr><tr><td><code>services/authApi.ts</code></td><td>è®¤è¯æ¥å£ï¼š<code>login()</code>ã€<code>getStatus()</code>ã€<code>setup()</code>ã€<code>changeCredentials()</code></td></tr><tr><td><code>services/subscriptionApi.ts</code></td><td>è®¢é˜…æ¥å£ï¼šCRUDã€<code>toggle()</code>ã€<code>check()</code>ã€<code>getHistory()</code></td></tr><tr><td><code>services/mikanApi.ts</code></td><td>Mikan æ¥å£ï¼š<code>search()</code>ã€<code>getFeed()</code>ã€<code>download()</code>ã€<code>getTorrents()</code>ã€ç§å­æ§åˆ¶</td></tr><tr><td><code>services/settingsApi.ts</code></td><td>è®¾ç½®æ¥å£ï¼š<code>getProfile()</code>ã€<code>saveProfile()</code>ã€<code>testQBittorrent()</code>ã€Token ç®¡ç†</td></tr></tbody></table><h3 id="utility-functions" tabindex="-1">Utility Functions <a class="header-anchor" href="#utility-functions" aria-label="Permalink to &quot;Utility Functions&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>utils/formatFileSize.ts</code></td><td>å°†å­—èŠ‚æ•°æ ¼å¼åŒ–ä¸ºäººç±»å¯è¯»å­—ç¬¦ä¸²ï¼ˆKB/MB/GBï¼‰</td></tr><tr><td><code>utils/torrentState.ts</code></td><td>qBittorrent ç§å­çŠ¶æ€æšä¸¾åŠçŠ¶æ€æ–‡å­—/é¢œè‰²æ˜ å°„</td></tr></tbody></table><h3 id="é€šç”¨ç»„ä»¶-components-common" tabindex="-1">é€šç”¨ç»„ä»¶ (components/common) <a class="header-anchor" href="#é€šç”¨ç»„ä»¶-components-common" aria-label="Permalink to &quot;é€šç”¨ç»„ä»¶ (components/common)&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>common/ErrorMessage.tsx</code></td><td>é”™è¯¯ä¿¡æ¯å±•ç¤ºç»„ä»¶ï¼Œå«é‡è¯•æŒ‰é’®</td></tr><tr><td><code>common/LoadingSpinner.tsx</code></td><td>åŠ è½½åŠ¨ç”»ç»„ä»¶</td></tr><tr><td><code>common/ToastContainer.tsx</code></td><td>Toast é€šçŸ¥å®¹å™¨ï¼ˆå…¨å±€æ¶ˆæ¯æç¤ºï¼‰</td></tr></tbody></table><h3 id="å›¾æ ‡ç»„ä»¶-components-icons" tabindex="-1">å›¾æ ‡ç»„ä»¶ (components/icons) <a class="header-anchor" href="#å›¾æ ‡ç»„ä»¶-components-icons" aria-label="Permalink to &quot;å›¾æ ‡ç»„ä»¶ (components/icons)&quot;">â€‹</a></h3><p>18 ä¸ªçº¯ SVG å›¾æ ‡ç»„ä»¶ï¼ŒåŒ…æ‹¬ï¼š<code>HomeIcon</code>ã€<code>DownloadIcon</code>ã€<code>SettingIcon</code>ã€<code>SidebarIcon</code>ã€<code>LanguageToggleIcon</code>ã€<code>LogoutIcon</code>ã€<code>GithubIcon</code>ã€<code>BellIcon</code>ã€<code>CheckIcon</code>ã€<code>CloseIcon</code>ã€<code>ExternalLinkIcon</code>ã€<code>EyeClosedIcon</code>ã€<code>EyeOpenIcon</code>ã€<code>PlayTriangleIcon</code>ã€<code>SearchIcon</code>ã€<code>ShuffleIcon</code>ã€<code>StarIcon</code></p><h3 id="è®¤è¯åŠŸèƒ½-features-auth" tabindex="-1">è®¤è¯åŠŸèƒ½ (features/auth) <a class="header-anchor" href="#è®¤è¯åŠŸèƒ½-features-auth" aria-label="Permalink to &quot;è®¤è¯åŠŸèƒ½ (features/auth)&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>features/auth/components/LoginBlock.tsx</code></td><td>ç™»å½•è¡¨å•ï¼šç”¨æˆ·å/å¯†ç è¾“å…¥ã€ç™»å½•æŒ‰é’®ã€é”™è¯¯æç¤ºã€èƒŒæ™¯å›¾å±•ç¤º</td></tr></tbody></table><h3 id="å®‰è£…å‘å¯¼åŠŸèƒ½-features-setup" tabindex="-1">å®‰è£…å‘å¯¼åŠŸèƒ½ (features/setup) <a class="header-anchor" href="#å®‰è£…å‘å¯¼åŠŸèƒ½-features-setup" aria-label="Permalink to &quot;å®‰è£…å‘å¯¼åŠŸèƒ½ (features/setup)&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>features/setup/SetupPage.tsx</code></td><td>5 æ­¥å®‰è£…å‘å¯¼ï¼šåˆ›å»ºè´¦æˆ·â†’qBittorrentâ†’TMDBâ†’åå¥½è®¾ç½®â†’éªŒè¯</td></tr></tbody></table><h3 id="ä¸»åŠŸèƒ½-features-home" tabindex="-1">ä¸»åŠŸèƒ½ (features/home) <a class="header-anchor" href="#ä¸»åŠŸèƒ½-features-home" aria-label="Permalink to &quot;ä¸»åŠŸèƒ½ (features/home)&quot;">â€‹</a></h3><p><strong>å¸ƒå±€ç»„ä»¶</strong></p><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>layout/HomePage.tsx</code></td><td>ä¸»å¸ƒå±€ï¼šSidebar + å†…å®¹åŒº + React Router è·¯ç”±å‡ºå£</td></tr><tr><td><code>layout/SideBar.tsx</code></td><td>å¯æŠ˜å ä¾§è¾¹æ ï¼šå¯¼èˆªé“¾æ¥ã€ç”¨æˆ·ä¿¡æ¯ã€è¯­è¨€åˆ‡æ¢ã€é€€å‡ºç™»å½•</td></tr><tr><td><code>layout/SideBarButton.tsx</code></td><td>ä¾§è¾¹æ æŒ‰é’®å¤ç”¨ç»„ä»¶ï¼šå›¾æ ‡+æ ‡ç­¾+æ¿€æ´»çŠ¶æ€</td></tr></tbody></table><p><strong>å†…å®¹ç»„ä»¶</strong></p><table tabindex="0"><thead><tr><th>æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>components/HomePageContent.tsx</code></td><td>ä»Šæ—¥æ”¾é€ä¸»é¡µï¼šä» API è·å–æ•°æ®ã€å±•ç¤ºå¤šä¸ª AnimeInfoFlow è½®æ’­</td></tr><tr><td><code>components/AnimeInfoFlow.tsx</code></td><td>æ¨ªå‘å¯æ»šåŠ¨ç•ªå‰§å¡ç‰‡è½®æ’­ï¼Œæ”¯æŒé¼ æ ‡æ‹–æ‹½</td></tr><tr><td><code>components/AnimeCard.tsx</code></td><td>å•ä¸ªç•ªå‰§å¡ç‰‡ï¼šå°é¢å›¾ã€è¯„åˆ†ã€æ ‡é¢˜ã€hover æ•ˆæœ</td></tr><tr><td><code>components/AnimeDetailModal.tsx</code></td><td>ç•ªå‰§è¯¦æƒ…å¼¹çª—ï¼šèƒŒæ™¯å›¾ã€åŒè¯­ç®€ä»‹ã€å¤–éƒ¨é“¾æ¥ï¼Œ<code>createPortal</code> æ¸²æŸ“</td></tr><tr><td><code>components/SearchPage.tsx</code></td><td>æœç´¢é¡µé¢ï¼šMikan æœç´¢ã€RSS è¿‡æ»¤ã€èµ„æºåˆ—è¡¨ã€ä¸€é”®ä¸‹è½½</td></tr><tr><td><code>components/DownloadPage.tsx</code></td><td>ä¸‹è½½ç®¡ç†é¡µï¼šqBittorrent ç§å­åˆ—è¡¨ã€è¿›åº¦ã€æš‚åœ/æ¢å¤/åˆ é™¤</td></tr><tr><td><code>components/MySubscriptionDownloadPage.tsx</code></td><td>è®¢é˜…ä¸‹è½½é¡µï¼šè®¢é˜…åˆ—è¡¨ + å„è®¢é˜…ä¸‹è½½å†å²</td></tr><tr><td><code>components/SubscriptionDownloadDetailModal.tsx</code></td><td>è®¢é˜…è¯¦æƒ…å¼¹çª—ï¼šRSS é…ç½®ã€ä¸‹è½½å†å²è®°å½•</td></tr><tr><td><code>components/SubscriptionInfo.tsx</code></td><td>è®¢é˜…ä¿¡æ¯å±•ç¤ºï¼šè®¢é˜…é…ç½®æ‘˜è¦</td></tr><tr><td><code>components/DownloadActionButton.tsx</code></td><td>ä¸‹è½½åŠ¨ä½œæŒ‰é’®ï¼šæ ¹æ®çŠ¶æ€æ˜¾ç¤ºä¸åŒæŒ‰é’®ï¼ˆä¸‹è½½/å·²è®¢é˜…/å–æ¶ˆï¼‰</td></tr><tr><td><code>components/DownloadEpisodeGroup.tsx</code></td><td>æŒ‰é›†æ•°åˆ†ç»„çš„èµ„æºåˆ—è¡¨</td></tr><tr><td><code>components/SettingPage.tsx</code></td><td>è®¾ç½®é¡µé¢ï¼šqBittorrentã€TMDB Tokenã€è½®è¯¢é…ç½®</td></tr></tbody></table><hr><h2 id="åç«¯-api-å‚è€ƒ" tabindex="-1">åç«¯ API å‚è€ƒ <a class="header-anchor" href="#åç«¯-api-å‚è€ƒ" aria-label="Permalink to &quot;åç«¯ API å‚è€ƒ&quot;">â€‹</a></h2><p>æ‰€æœ‰ API å‡éœ€ JWT è®¤è¯ï¼ˆBearer Tokenï¼‰ï¼Œæ ‡æ³¨ <code>ğŸ”“</code> çš„ç«¯ç‚¹é™¤å¤–ã€‚</p><h3 id="è®¤è¯-api-auth" tabindex="-1">è®¤è¯ <code>/api/auth</code> <a class="header-anchor" href="#è®¤è¯-api-auth" aria-label="Permalink to &quot;è®¤è¯ \`/api/auth\`&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>Method</th><th>è·¯å¾„</th><th>è®¤è¯</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>GET</code></td><td><code>/api/auth/status</code></td><td>ğŸ”“</td><td>æŸ¥è¯¢ç³»ç»Ÿæ˜¯å¦å·²åˆå§‹åŒ–ã€å½“å‰æ˜¯å¦å·²ç™»å½•</td></tr><tr><td><code>POST</code></td><td><code>/api/auth/login</code></td><td>ğŸ”“</td><td>ç”¨æˆ·ç™»å½•ï¼Œè¿”å› JWT Token</td></tr><tr><td><code>POST</code></td><td><code>/api/auth/setup</code></td><td>ğŸ”“</td><td>é¦–æ¬¡å®‰è£…å‘å¯¼ï¼Œåˆ›å»ºåˆå§‹è´¦æˆ·å’Œé…ç½®</td></tr><tr><td><code>POST</code></td><td><code>/api/auth/change-credentials</code></td><td>ğŸ”’</td><td>ä¿®æ”¹ç”¨æˆ·åæˆ–å¯†ç </td></tr><tr><td><code>GET</code></td><td><code>/api/auth/background</code></td><td>ğŸ”“</td><td>è·å–ç™»å½•é¡µèƒŒæ™¯å›¾ï¼ˆè¿”å›å›¾ç‰‡æ–‡ä»¶ï¼‰</td></tr><tr><td><code>POST</code></td><td><code>/api/auth/background</code></td><td>ğŸ”’</td><td>ä¸Šä¼ è‡ªå®šä¹‰ç™»å½•èƒŒæ™¯å›¾</td></tr><tr><td><code>DELETE</code></td><td><code>/api/auth/background</code></td><td>ğŸ”’</td><td>åˆ é™¤è‡ªå®šä¹‰èƒŒæ™¯å›¾ï¼Œæ¢å¤é»˜è®¤</td></tr></tbody></table><h3 id="åŠ¨æ¼«æ•°æ®-api-anime" tabindex="-1">åŠ¨æ¼«æ•°æ® <code>/api/anime</code> <a class="header-anchor" href="#åŠ¨æ¼«æ•°æ®-api-anime" aria-label="Permalink to &quot;åŠ¨æ¼«æ•°æ® \`/api/anime\`&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>Method</th><th>è·¯å¾„</th><th>è®¤è¯</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>GET</code></td><td><code>/api/anime/today</code></td><td>ğŸ”’</td><td>è·å–æœ¬å‘¨æ”¾é€ç•ªå‰§ï¼ˆDBä¼˜å…ˆï¼Œå›é€€å®æ—¶èšåˆï¼‰</td></tr><tr><td><code>GET</code></td><td><code>/api/anime/top/bangumi</code></td><td>ğŸ”’</td><td>Bangumi è¯„åˆ† Top 10</td></tr><tr><td><code>GET</code></td><td><code>/api/anime/top/anilist</code></td><td>ğŸ”’</td><td>AniList è¶‹åŠ¿ Top 10</td></tr><tr><td><code>GET</code></td><td><code>/api/anime/top/mal</code></td><td>ğŸ”’</td><td>MyAnimeList Top 10ï¼ˆvia Jikanï¼‰</td></tr><tr><td><code>GET</code></td><td><code>/api/anime/search?keyword=</code></td><td>ğŸ”’</td><td>æœç´¢åŠ¨æ¼«ï¼ˆMikan ä¸»æº + Bangumi è¡¥å……ï¼‰</td></tr><tr><td><code>GET</code></td><td><code>/api/anime/random</code></td><td>ğŸ”’</td><td>è·å–éšæœºæ¨èç•ªå‰§åˆ—è¡¨</td></tr><tr><td><code>POST</code></td><td><code>/api/anime/batch</code></td><td>ğŸ”’</td><td>æ‰¹é‡æŸ¥è¯¢ Bangumi ID å¯¹åº”çš„ç•ªå‰§ä¿¡æ¯ï¼ˆä»æœ¬åœ° DBï¼‰</td></tr></tbody></table><h3 id="è®¢é˜…ç®¡ç†-api-subscription" tabindex="-1">è®¢é˜…ç®¡ç† <code>/api/subscription</code> <a class="header-anchor" href="#è®¢é˜…ç®¡ç†-api-subscription" aria-label="Permalink to &quot;è®¢é˜…ç®¡ç† \`/api/subscription\`&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>Method</th><th>è·¯å¾„</th><th>è®¤è¯</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>GET</code></td><td><code>/api/subscription</code></td><td>ğŸ”’</td><td>è·å–æ‰€æœ‰è®¢é˜…åˆ—è¡¨</td></tr><tr><td><code>GET</code></td><td><code>/api/subscription/{id}</code></td><td>ğŸ”’</td><td>è·å–å•ä¸ªè®¢é˜…è¯¦æƒ…</td></tr><tr><td><code>GET</code></td><td><code>/api/subscription/bangumi/{bangumiId}</code></td><td>ğŸ”’</td><td>æŒ‰ Bangumi ID æŸ¥è¯¢è®¢é˜…</td></tr><tr><td><code>POST</code></td><td><code>/api/subscription</code></td><td>ğŸ”’</td><td>åˆ›å»ºæ–°è®¢é˜…</td></tr><tr><td><code>PUT</code></td><td><code>/api/subscription/{id}</code></td><td>ğŸ”’</td><td>æ›´æ–°è®¢é˜…é…ç½®</td></tr><tr><td><code>DELETE</code></td><td><code>/api/subscription/{id}</code></td><td>ğŸ”’</td><td>åˆ é™¤è®¢é˜…ï¼ˆä¿ç•™ä¸‹è½½å†å²ï¼‰</td></tr><tr><td><code>POST</code></td><td><code>/api/subscription/{id}/toggle?enabled=</code></td><td>ğŸ”’</td><td>å¯ç”¨/ç¦ç”¨è®¢é˜…</td></tr><tr><td><code>POST</code></td><td><code>/api/subscription/{id}/check</code></td><td>ğŸ”’</td><td>ç«‹å³æ‰‹åŠ¨æ£€æŸ¥è¯¥è®¢é˜… RSS</td></tr><tr><td><code>POST</code></td><td><code>/api/subscription/check-all</code></td><td>ğŸ”’</td><td>ç«‹å³æ£€æŸ¥æ‰€æœ‰å·²å¯ç”¨è®¢é˜…</td></tr><tr><td><code>POST</code></td><td><code>/api/subscription/ensure</code></td><td>ğŸ”’</td><td>ç¡®ä¿è®¢é˜…å­˜åœ¨ä¸”å¯ç”¨ï¼ˆå¹‚ç­‰ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»ºï¼‰</td></tr><tr><td><code>POST</code></td><td><code>/api/subscription/{id}/cancel</code></td><td>ğŸ”’</td><td>å–æ¶ˆè®¢é˜…ï¼ˆå¯é€‰åˆ é™¤å·²ä¸‹è½½æ–‡ä»¶ï¼‰</td></tr><tr><td><code>GET</code></td><td><code>/api/subscription/{id}/history</code></td><td>ğŸ”’</td><td>è·å–è®¢é˜…ä¸‹è½½å†å²</td></tr><tr><td><code>GET</code></td><td><code>/api/subscription/{id}/task-hashes</code></td><td>ğŸ”’</td><td>è·å–è®¢é˜…å…³è”çš„ qBittorrent ä»»åŠ¡ Hash</td></tr><tr><td><code>GET</code></td><td><code>/api/subscription/manual-anime</code></td><td>ğŸ”’</td><td>è·å–æœ‰æ‰‹åŠ¨ä¸‹è½½ä½†æ— è®¢é˜…çš„ç•ªå‰§åˆ—è¡¨</td></tr><tr><td><code>GET</code></td><td><code>/api/subscription/manual-anime/{bangumiId}/history</code></td><td>ğŸ”’</td><td>è·å–ç•ªå‰§æ‰‹åŠ¨ä¸‹è½½å†å²</td></tr><tr><td><code>GET</code></td><td><code>/api/subscription/manual-anime/{bangumiId}/task-hashes</code></td><td>ğŸ”’</td><td>è·å–æ‰‹åŠ¨ä¸‹è½½çš„ä»»åŠ¡ Hash</td></tr></tbody></table><h3 id="mikan-ä¸‹è½½-api-mikan" tabindex="-1">Mikan &amp; ä¸‹è½½ <code>/api/mikan</code> <a class="header-anchor" href="#mikan-ä¸‹è½½-api-mikan" aria-label="Permalink to &quot;Mikan &amp; ä¸‹è½½ \`/api/mikan\`&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>Method</th><th>è·¯å¾„</th><th>è®¤è¯</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>GET</code></td><td><code>/api/mikan/search?keyword=</code></td><td>ğŸ”’</td><td>åœ¨ Mikan æœç´¢ç•ªå‰§ï¼Œè¿”å›æ‰€æœ‰å­£åº¦åˆ—è¡¨</td></tr><tr><td><code>GET</code></td><td><code>/api/mikan/search-entries?keyword=</code></td><td>ğŸ”’</td><td>æœç´¢ Mikan ç•ªå‰§æ¡ç›®</td></tr><tr><td><code>POST</code></td><td><code>/api/mikan/correct-bangumi-id</code></td><td>ğŸ”’</td><td>ä¿®æ­£ Mikan Bangumi ID æ˜ å°„</td></tr><tr><td><code>GET</code></td><td><code>/api/mikan/subgroups?mikanBangumiId=</code></td><td>ğŸ”’</td><td>è·å–ç•ªå‰§çš„å­—å¹•ç»„åˆ—è¡¨ï¼ˆåç§°/IDï¼‰</td></tr><tr><td><code>GET</code></td><td><code>/api/mikan/feed?mikanBangumiId=&amp;subgroupId=</code></td><td>ğŸ”’</td><td>è·å–ç•ªå‰§ RSS èµ„æºåˆ—è¡¨ï¼ˆå«é›†æ•°å½’ä¸€åŒ–ï¼‰</td></tr><tr><td><code>GET</code></td><td><code>/api/mikan/filter</code></td><td>ğŸ”’</td><td>æŒ‰åˆ†è¾¨ç‡/å­—å¹•ç±»å‹è¿‡æ»¤ RSS åˆ—è¡¨</td></tr><tr><td><code>POST</code></td><td><code>/api/mikan/download</code></td><td>ğŸ”’</td><td>å‘é€ç§å­åˆ° qBittorrent ä¸‹è½½</td></tr><tr><td><code>GET</code></td><td><code>/api/mikan/torrents?hashes=</code></td><td>ğŸ”’</td><td>æŸ¥è¯¢æŒ‡å®š Hash çš„ qBittorrent ä¸‹è½½çŠ¶æ€</td></tr><tr><td><code>POST</code></td><td><code>/api/mikan/torrents/{hash}/pause</code></td><td>ğŸ”’</td><td>æš‚åœæŒ‡å®šç§å­</td></tr><tr><td><code>POST</code></td><td><code>/api/mikan/torrents/{hash}/resume</code></td><td>ğŸ”’</td><td>æ¢å¤æŒ‡å®šç§å­</td></tr><tr><td><code>DELETE</code></td><td><code>/api/mikan/torrents/{hash}</code></td><td>ğŸ”’</td><td>åˆ é™¤æŒ‡å®šç§å­ï¼ˆå¯é€‰åˆ æ–‡ä»¶ï¼‰</td></tr></tbody></table><h3 id="è®¾ç½®-api-settings" tabindex="-1">è®¾ç½® <code>/api/settings</code> <a class="header-anchor" href="#è®¾ç½®-api-settings" aria-label="Permalink to &quot;è®¾ç½® \`/api/settings\`&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>Method</th><th>è·¯å¾„</th><th>è®¤è¯</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>GET</code></td><td><code>/api/settings/tokens</code></td><td>ğŸ”’</td><td>æŸ¥çœ‹ Token é…ç½®çŠ¶æ€ï¼ˆè¿”å›è„±æ•ä¿¡æ¯ï¼‰</td></tr><tr><td><code>PUT</code></td><td><code>/api/settings/tokens</code></td><td>ğŸ”’</td><td>æ›´æ–° TMDB Token</td></tr><tr><td><code>DELETE</code></td><td><code>/api/settings/tokens</code></td><td>ğŸ”’</td><td>åˆ é™¤å·²å­˜å‚¨çš„ TMDB Token</td></tr><tr><td><code>GET</code></td><td><code>/api/settings/profile</code></td><td>ğŸ”’</td><td>è·å–è®¾ç½®é¡µå®Œæ•´é…ç½®ï¼ˆqBittorrent/Mikan/Tokenï¼‰</td></tr><tr><td><code>PUT</code></td><td><code>/api/settings/profile</code></td><td>ğŸ”’</td><td>ä¿å­˜è®¾ç½®é¡µé…ç½®</td></tr><tr><td><code>POST</code></td><td><code>/api/settings/test/tmdb</code></td><td>ğŸ”“</td><td>æµ‹è¯• TMDB Token æœ‰æ•ˆæ€§</td></tr><tr><td><code>POST</code></td><td><code>/api/settings/test/qbittorrent</code></td><td>ğŸ”“</td><td>æµ‹è¯• qBittorrent è¿æ¥</td></tr><tr><td><code>POST</code></td><td><code>/api/settings/test/mikan-polling</code></td><td>ğŸ”“</td><td>éªŒè¯ Mikan è½®è¯¢é—´éš”é…ç½®</td></tr></tbody></table><h3 id="ç®¡ç†-api-admin" tabindex="-1">ç®¡ç† <code>/api/admin</code> <a class="header-anchor" href="#ç®¡ç†-api-admin" aria-label="Permalink to &quot;ç®¡ç† \`/api/admin\`&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>Method</th><th>è·¯å¾„</th><th>è®¤è¯</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>GET</code></td><td><code>/api/admin/prefetch/status</code></td><td>ğŸ”’</td><td>è·å–é¢„å–æœåŠ¡è¿è¡ŒçŠ¶æ€</td></tr><tr><td><code>POST</code></td><td><code>/api/admin/prefetch</code></td><td>ğŸ”’</td><td>æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡æ•°æ®é¢„å–</td></tr><tr><td><code>GET</code></td><td><code>/api/admin/prefetch/stats</code></td><td>ğŸ”’</td><td>è·å–æ•°æ®åº“é¢„å–ç»Ÿè®¡ï¼ˆæ¡æ•°/æœ€æ–°æ—¶é—´ï¼‰</td></tr><tr><td><code>DELETE</code></td><td><code>/api/admin/prefetch/data</code></td><td>ğŸ”’</td><td>æ¸…ç©ºæ‰€æœ‰é¢„å–æ•°æ®</td></tr></tbody></table><h3 id="å¥åº·æ£€æŸ¥-health" tabindex="-1">å¥åº·æ£€æŸ¥ <code>/health</code> <a class="header-anchor" href="#å¥åº·æ£€æŸ¥-health" aria-label="Permalink to &quot;å¥åº·æ£€æŸ¥ \`/health\`&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>Method</th><th>è·¯å¾„</th><th>è®¤è¯</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>GET</code></td><td><code>/health</code></td><td>ğŸ”“</td><td>æœåŠ¡å¿ƒè·³æ£€æŸ¥ï¼Œè¿”å› <code>{ status: &quot;healthy&quot; }</code></td></tr><tr><td><code>GET</code></td><td><code>/health/dependencies</code></td><td>ğŸ”’</td><td>æ£€æŸ¥ Bangumi/TMDB/AniList è¿é€šæ€§</td></tr></tbody></table><hr><h2 id="æ•°æ®åº“-schema" tabindex="-1">æ•°æ®åº“ Schema <a class="header-anchor" href="#æ•°æ®åº“-schema" aria-label="Permalink to &quot;æ•°æ®åº“ Schema&quot;">â€‹</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>AnimeInfo          AnimeImages        Subscriptions       DownloadHistory</span></span>
<span class="line"><span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span>
<span class="line"><span>BangumiId (PK)     BangumiId (PK)     Id (PK AUTO)        Id (PK AUTO)</span></span>
<span class="line"><span>NameJapanese       PosterUrl          BangumiId           SubscriptionId (FK)</span></span>
<span class="line"><span>NameChinese        BackdropUrl        Title               TorrentUrl</span></span>
<span class="line"><span>NameEnglish        TmdbId             MikanBangumiId      TorrentHash (UNIQUE)</span></span>
<span class="line"><span>DescChinese        AniListId          SubgroupId          Title</span></span>
<span class="line"><span>DescEnglish        CreatedAt          SubgroupName        FileSize</span></span>
<span class="line"><span>Score              UpdatedAt          KeywordInclude      Status (0-4)</span></span>
<span class="line"><span>ImagePortrait                         KeywordExclude      DownloadSource</span></span>
<span class="line"><span>ImageLandscape                        IsEnabled           ErrorMessage</span></span>
<span class="line"><span>TmdbId                                LastCheckedAt       PublishedAt</span></span>
<span class="line"><span>AnilistId                             LastDownloadAt      DiscoveredAt</span></span>
<span class="line"><span>MikanBangumiId                        DownloadCount       DownloadedAt</span></span>
<span class="line"><span>Weekday                               CreatedAt</span></span>
<span class="line"><span>AirDate                               UpdatedAt</span></span>
<span class="line"><span>IsPreFetched</span></span>
<span class="line"><span>CreatedAt/UpdatedAt</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>MikanFeedCache         MikanFeedItem         MikanSubgroup</span></span>
<span class="line"><span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span>
<span class="line"><span>Id (PK)                Id (PK)               MikanBangumiId (PK)</span></span>
<span class="line"><span>MikanBangumiId         FeedCacheId (FK)      SubgroupId (PK)</span></span>
<span class="line"><span>SubgroupId             Title                 SubgroupName</span></span>
<span class="line"><span>FetchedAt              TorrentUrl            CreatedAt</span></span>
<span class="line"><span>ExpiresAt              TorrentHash</span></span>
<span class="line"><span>                       PublishedAt</span></span>
<span class="line"><span>                       FileSize</span></span>
<span class="line"><span>                       Episode</span></span>
<span class="line"><span></span></span>
<span class="line"><span>TopAnimeCache          User</span></span>
<span class="line"><span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€</span></span>
<span class="line"><span>Id (PK)                Id (PK AUTO)</span></span>
<span class="line"><span>Source                 Username (UNIQUE)</span></span>
<span class="line"><span>DataJson               PasswordHash</span></span>
<span class="line"><span>FetchedAt              CreatedAt</span></span>
<span class="line"><span>ExpiresAt              UpdatedAt</span></span></code></pre></div>`,83)])])}const b=e(s,[["render",o]]);export{u as __pageData,b as default};

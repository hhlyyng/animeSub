import{_ as a,o as n,c as s,a2 as e}from"./chunks/framework.D3n7QxxD.js";const b=JSON.parse('{"title":"项目介绍","description":"","frontmatter":{},"headers":[],"relativePath":"zh/introduction.md","filePath":"zh/introduction.md"}'),i={name:"zh/introduction.md"};function r(d,t,l,o,p,h){return n(),s("div",null,[...t[0]||(t[0]=[e(`<h1 id="项目介绍" tabindex="-1">项目介绍 <a class="header-anchor" href="#项目介绍" aria-label="Permalink to &quot;项目介绍&quot;">​</a></h1><p>AnimeSub 是一个自托管的动漫订阅与自动下载应用。它聚合多个动漫数据库，展示每日放送计划，并通过 Mikan RSS 实现番剧的自动追踪与下载。</p><h2 id="功能一览" tabindex="-1">功能一览 <a class="header-anchor" href="#功能一览" aria-label="Permalink to &quot;功能一览&quot;">​</a></h2><ul><li><strong>每日放送</strong>：按星期展示动漫放送时间表，数据来自 Bangumi，附带 TMDB 横版背景图</li><li><strong>Top 10 排行</strong>：同时展示 Bangumi、AniList 趋势、MyAnimeList 三榜排行</li><li><strong>搜索下载</strong>：以 Mikan 为主源搜索番剧资源，支持按分辨率、字幕类型筛选</li><li><strong>订阅管理</strong>：创建/编辑/删除订阅，支持关键词包含/排除、字幕组筛选</li><li><strong>自动下载</strong>：RSS 后台轮询服务，新资源自动推送到 qBittorrent</li><li><strong>下载管理</strong>：查看种子列表、暂停/恢复/删除任务、实时进度追踪</li><li><strong>Web 设置</strong>：浏览器内完成所有配置，无需编辑配置文件</li></ul><h2 id="系统架构" tabindex="-1">系统架构 <a class="header-anchor" href="#系统架构" aria-label="Permalink to &quot;系统架构&quot;">​</a></h2><h3 id="数据聚合流程" tabindex="-1">数据聚合流程 <a class="header-anchor" href="#数据聚合流程" aria-label="Permalink to &quot;数据聚合流程&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>前端请求 → AnimeController</span></span>
<span class="line"><span>    ├── Bangumi API  → 每日放送、评分、竖版封面、放送日期（主数据源）</span></span>
<span class="line"><span>    ├── TMDB API     → 英文元数据、横版背景图（智能匹配）</span></span>
<span class="line"><span>    └── AniList GraphQL → 英文标题/简介（备用）</span></span>
<span class="line"><span>    ↓</span></span>
<span class="line"><span>AnimeInfo[] → 前端缓存至 sessionStorage</span></span></code></pre></div><p><strong>TMDB 智能匹配策略</strong>：</p><ul><li>优先选择 Animation 类型（genre_id=16），避免真人剧污染结果</li><li>同等条件下优先日本出品（origin_country=JP）</li><li>利用 Bangumi <code>air_date</code> 年份过滤多季度系列，匹配对应季度图片</li></ul><h3 id="订阅与下载流程" tabindex="-1">订阅与下载流程 <a class="header-anchor" href="#订阅与下载流程" aria-label="Permalink to &quot;订阅与下载流程&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>用户创建订阅 → SubscriptionController</span></span>
<span class="line"><span>    ↓</span></span>
<span class="line"><span>RssPollingService（后台服务，每 30 分钟）</span></span>
<span class="line"><span>    ├── 获取 Mikan RSS 订阅源</span></span>
<span class="line"><span>    ├── 按字幕组/关键词过滤</span></span>
<span class="line"><span>    ├── 与 DownloadHistory 对比去重（按 torrent hash）</span></span>
<span class="line"><span>    └── 推送新种子到 qBittorrent</span></span></code></pre></div><h3 id="预取架构" tabindex="-1">预取架构 <a class="header-anchor" href="#预取架构" aria-label="Permalink to &quot;预取架构&quot;">​</a></h3><p>为了实现 &lt;100ms 的响应时间，系统在凌晨批量预取全周放送数据并存入 SQLite 数据库：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>预取服务（每日凌晨 3 点）</span></span>
<span class="line"><span>    ↓</span></span>
<span class="line"><span>获取完整周历 → 批量聚合 Bangumi + TMDB + AniList 数据</span></span>
<span class="line"><span>    ↓</span></span>
<span class="line"><span>写入 SQLite → 前端请求直接读取数据库（&lt;100ms）</span></span></code></pre></div><table tabindex="0"><thead><tr><th>对比项</th><th>实时聚合（旧）</th><th>预取架构（现）</th></tr></thead><tbody><tr><td>响应时间</td><td>3–10 秒</td><td>&lt;100ms</td></tr><tr><td>API 调用时机</td><td>每次请求</td><td>仅凌晨批量</td></tr><tr><td>故障影响</td><td>外部 API 故障影响用户</td><td>数据库保底，API 故障不感知</td></tr></tbody></table><h2 id="技术栈" tabindex="-1">技术栈 <a class="header-anchor" href="#技术栈" aria-label="Permalink to &quot;技术栈&quot;">​</a></h2><table tabindex="0"><thead><tr><th>层级</th><th>技术</th></tr></thead><tbody><tr><td>前端</td><td>React 19 + TypeScript + Vite + Tailwind CSS + Zustand</td></tr><tr><td>后端</td><td>.NET 9 ASP.NET Core</td></tr><tr><td>数据库</td><td>SQLite（通过 Entity Framework Core）</td></tr><tr><td>容器化</td><td>Docker + Docker Compose</td></tr><tr><td>认证</td><td>JWT（HMAC-SHA256）+ bcrypt</td></tr></tbody></table><h2 id="外部服务依赖" tabindex="-1">外部服务依赖 <a class="header-anchor" href="#外部服务依赖" aria-label="Permalink to &quot;外部服务依赖&quot;">​</a></h2><table tabindex="0"><thead><tr><th>服务</th><th>用途</th><th>是否必须</th></tr></thead><tbody><tr><td><a href="https://bangumi.tv" target="_blank" rel="noreferrer">Bangumi</a></td><td>每日放送、评分、封面图</td><td>是</td></tr><tr><td><a href="https://www.themoviedb.org" target="_blank" rel="noreferrer">TMDB</a></td><td>英文元数据、横版背景图</td><td>否（禁用则无英文内容和背景图）</td></tr><tr><td><a href="https://anilist.co" target="_blank" rel="noreferrer">AniList</a></td><td>英文标题/简介备用</td><td>否</td></tr><tr><td><a href="https://mikanani.me" target="_blank" rel="noreferrer">Mikan</a></td><td>番剧 RSS 资源</td><td>订阅功能需要</td></tr><tr><td>qBittorrent</td><td>种子下载管理</td><td>下载功能需要</td></tr></tbody></table>`,19)])])}const u=a(i,[["render",r]]);export{b as __pageData,u as default};
